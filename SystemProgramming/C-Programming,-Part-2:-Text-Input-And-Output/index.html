<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>C Programming, Part 2: Text Input And Output - UIUC CS241 SystemProgramming Wiki</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../../css/highlight.css">
  
  <script>
    // Current page data
    var mkdocs_page_name = "C Programming, Part 2: Text Input And Output";
    var mkdocs_page_input_path = "SystemProgramming/C-Programming,-Part-2:-Text-Input-And-Output.md";
    var mkdocs_page_url = "/SystemProgramming/C-Programming,-Part-2:-Text-Input-And-Output/";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js"></script>
  <script src="../../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../../js/highlight.pack.js"></script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> UIUC CS241 SystemProgramming Wiki</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
          
            <li>
    <li class="toctree-l1 ">
        <a class="" href="../..">Home</a>
        
    </li>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>SystemProgramming</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../#Example Markdown/">#Example Markdown</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../#Informal-Glossary/">#Informal Glossary</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../#Piazza: When And How to Ask For Help/">#Piazza: When And How to Ask For Help</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming,-Part-1:-Introduction/">C Programming, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">C Programming, Part 2: Text Input And Output</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#printing-to-streams">Printing to Streams</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-print-strings-ints-chars-to-the-standard-output-stream">How do I print strings, ints, chars to the standard output stream?</a></li>
                
                    <li><a class="toctree-l4" href="#how-else-can-i-print-strings-and-single-characters">How else can I print strings and single characters?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-print-to-other-file-streams">How do I print to other file streams?</a></li>
                
                    <li><a class="toctree-l4" href="#can-i-use-file-descriptors">Can I use file descriptors?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-print-data-into-a-c-string">How do I print data into a C string?</a></li>
                
                    <li><a class="toctree-l4" href="#what-if-i-really-really-want-printf-to-call-write-without-a-newline">What if I really really want printf to call write without a newline?</a></li>
                
                    <li><a class="toctree-l4" href="#how-is-perror-helpful">How is perror helpful?</a></li>
                
            
                <li class="toctree-l3"><a href="#parsing-input">Parsing Input</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-parse-numbers-from-strings">How do I parse numbers from strings?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-parse-input-using-scanf-into-parameters">How do I parse input using scanf into parameters?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-stop-scanf-from-causing-a-buffer-overflow">How do I stop scanf from causing a buffer overflow?</a></li>
                
                    <li><a class="toctree-l4" href="#why-is-gets-dangerous-what-should-i-use-instead">Why is gets dangerous? What should I use instead?</a></li>
                
                    <li><a class="toctree-l4" href="#how-do-i-use-getline">How do I use getline?</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming,-Part-3:-Common-Gotchas/">C Programming, Part 3: Common Gotchas</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming,-Part-4:-Strings-and-Structs/">C Programming, Part 4: Strings and Structs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming,-Part-5:-Debugging/">C Programming, Part 5: Debugging</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming,-Review-Questions/">C Programming, Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../C-Programming:-Review-Questions/">C Programming: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Deadlock,-Part-1:-Resource-Allocation-Graph/">Deadlock, Part 1: Resource Allocation Graph</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Deadlock,-Part-2:-Deadlock-Conditions/">Deadlock, Part 2: Deadlock Conditions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Deadlock,-Part-3:-Dining-Philosophers/">Deadlock, Part 3: Dining Philosophers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Deadlock-Review-Questions/">Deadlock Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Exam-Topics/">Exam Topics</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-1:-Introduction/">File System, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-2:-Files-are-inodes-(everything-else-is-just-data...)/">File System, Part 2: Files are inodes (everything else is just data...)</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-3:-Permissions/">File System, Part 3: Permissions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-4:-Working-with-directories/">File System, Part 4: Working with directories</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-5:-Virtual-file-systems/">File System, Part 5: Virtual file systems</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-6:-Memory-mapped-files-and-Shared-memory/">File System, Part 6: Memory mapped files and Shared memory</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-7:-Scalable-and-Reliable-Filesystems/">File System, Part 7: Scalable and Reliable Filesystems</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-8:-Removing-preinstalled-malware-from-an-Android-device/">File System, Part 8: Removing preinstalled malware from an Android device</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-System,-Part-9:-Disk-blocks-example/">File System, Part 9: Disk blocks example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../File-Systems-Review-Questions/">File Systems Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Files,-Part-1:-Working-with-files/">Files, Part 1: Working with files</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Filesystem:-Review-Questions/">Filesystem: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Forking,-Part-1:-Introduction/">Forking, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Forking,-Part-2:-Fork,-Exec,-Wait/">Forking, Part 2: Fork, Exec, Wait</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../HW0/">HW0</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Home/">Home</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../IPC-Review-Questions/">IPC Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Memory,-Part-1:-Heap-Memory-Introduction/">Memory, Part 1: Heap Memory Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Memory,-Part-2:-Implementing-a-Memory-Allocator/">Memory, Part 2: Implementing a Memory Allocator</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Memory,-Part-3:-Smashing-the-Stack-Example/">Memory, Part 3: Smashing the Stack Example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Memory-Review-Questions/">Memory Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Memory:-Review-Questions/">Memory: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Multi-threaded-Programming:-Review-Questions/">Multi threaded Programming: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-1:-Introduction/">Networking, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-2:-Using-getaddrinfo/">Networking, Part 2: Using getaddrinfo</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-3:-Building-a-simple-TCP-Client/">Networking, Part 3: Building a simple TCP Client</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-4:-Building-a-simple-TCP-Server/">Networking, Part 4: Building a simple TCP Server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-5:-Shutting-down-ports,-reusing-ports-and-other-tricks/">Networking, Part 5: Shutting down ports, reusing ports and other tricks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-6:-Building-a-web-server/">Networking, Part 6: Building a web server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-6:-Creating-a-UDP-server/">Networking, Part 6: Creating a UDP server</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking,-Part-7:-Nonblocking-I-O,-select(),-and-epoll/">Networking, Part 7: Nonblocking I O, select(), and epoll</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking-Review-Questions/">Networking Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Networking:-Review-Questions/">Networking: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../OSI-Model/">OSI Model</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../POSIX,-Part-1:-Error-handling/">POSIX, Part 1: Error handling</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pipe:-Review-Questions/">Pipe: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pipes,-Part-1:-Introduction-to-pipes/">Pipes, Part 1: Introduction to pipes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pipes,-Part-2:-Pipe-programming-secrets/">Pipes, Part 2: Pipe programming secrets</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Process-Control,-Part-1:-Wait-macros,-using-signals/">Process Control, Part 1: Wait macros, using signals</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Processes,-Part-1:-Introduction/">Processes, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Processes-Review-Questions/">Processes Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Programming-Tricks,-Part-1/">Programming Tricks, Part 1</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pthread-Review-Questions/">Pthread Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pthreads,-Part-1:-Introduction/">Pthreads, Part 1: Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pthreads,-Part-2:-Usage-in-Practice/">Pthreads, Part 2: Usage in Practice</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Pthreads,-Part-3:-Parallel-Problems-(Bonus)/">Pthreads, Part 3: Parallel Problems (Bonus)</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../RPC,-Part-1:-Introduction-to-Remote-Procedure-Calls/">RPC, Part 1: Introduction to Remote Procedure Calls</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Sample-program-using-pthread-barriers/">Sample program using pthread barriers</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Scheduling,-Part-1:-Scheduling-Processes/">Scheduling, Part 1: Scheduling Processes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Scheduling,-Part-2:-Scheduling-Processes:-Algorithms/">Scheduling, Part 2: Scheduling Processes: Algorithms</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Signals,-Part-2:-Pending-Signals-and-Signal-Masks/">Signals, Part 2: Pending Signals and Signal Masks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Signals,-Part-3:-Raising-signals/">Signals, Part 3: Raising signals</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Signals,-Part-4:-Sigaction/">Signals, Part 4: Sigaction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Signals-Review-Questions/">Signals Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Signals:-Review-Questions/">Signals: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-1:-Mutex-Locks/">Synchronization, Part 1: Mutex Locks</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-2:-Counting-Semaphores/">Synchronization, Part 2: Counting Semaphores</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-3:-Working-with-Mutexes-And-Semaphores/">Synchronization, Part 3: Working with Mutexes And Semaphores</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-4:-The-Critical-Section-Problem/">Synchronization, Part 4: The Critical Section Problem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-5:-Condition-Variables/">Synchronization, Part 5: Condition Variables</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-6:-Implementing-a-barrier/">Synchronization, Part 6: Implementing a barrier</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-7:-The-Reader-Writer-Problem/">Synchronization, Part 7: The Reader Writer Problem</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization,-Part-8:-Ring-Buffer-Example/">Synchronization, Part 8: Ring Buffer Example</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization-Concepts:-Review-Questions/">Synchronization Concepts: Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Synchronization-Review-Questions/">Synchronization Review Questions</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../System-Programming-Jokes/">System Programming Jokes</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../System-Programming-Short-Stories-and-Songs/">System Programming Short Stories and Songs</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Test-page/">Test page</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../Virtual-Memory,-Part-1:-Introduction-to-Virtual-Memory/">Virtual Memory, Part 1: Introduction to Virtual Memory</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../_Footer/"> Footer</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">UIUC CS241 SystemProgramming Wiki</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>SystemProgramming &raquo;</li>
        
      
    
    <li>C Programming, Part 2: Text Input And Output</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="printing-to-streams">Printing to Streams</h1>
<h2 id="how-do-i-print-strings-ints-chars-to-the-standard-output-stream">How do I print strings, ints, chars to the standard output stream?</h2>
<p>Use <code>printf</code>. The first parameter is a format string that includes placeholders for the data to be printed. Common format specifiers are <code>%s</code> treat the argument as a c string pointer, keep printing all characters until the NULL-character is reached; <code>%d</code> print the argument as an integer; <code>%p</code> print the argument as a memory address. </p>
<p>A simple example is shown below:</p>
<pre><code class="C">char *name = ... ; int score = ...;
printf(&quot;Hello %s, your result is %d\n&quot;, name, score);
printf(&quot;Debug: The string and int are stored at: %p and %p\n&quot;, name, &amp;score );
// name already is a char pointer and points to the start of the array. 
// We need &quot;&amp;&quot; to get the address of the int variable
</code></pre>

<p>By default, for performance, <code>printf</code> does not actually write anything out (by calling write) until its buffer is full or a newline is printed. </p>
<h2 id="how-else-can-i-print-strings-and-single-characters">How else can I print strings and single characters?</h2>
<p>Use <code>puts( name );</code> and <code>putchar( c )</code>  where name is a pointer to a C string and c is just a <code>char</code></p>
<h2 id="how-do-i-print-to-other-file-streams">How do I print to other file streams?</h2>
<p>Use <code>fprintf( _file_ , "Hello %s, score: %d", name, score);</code>
Where _file_ is either predefined 'stdout' 'stderr' or a FILE pointer that was returned by <code>fopen</code> or <code>fdopen</code></p>
<h2 id="can-i-use-file-descriptors">Can I use file descriptors?</h2>
<p>Yes! Just use <code>dprintf(int fd, char* format_string, ...);</code> Just remember the stream may be buffered, so you will need to assure that the data is written to the file descriptor.</p>
<h2 id="how-do-i-print-data-into-a-c-string">How do I print data into a C string?</h2>
<p>Use <code>sprintf</code> or better <code>snprintf</code>.</p>
<pre><code class="C">char result[200];
int len = snprintf(result, sizeof(result), &quot;%s:%d&quot;, name, score);
</code></pre>

<p>snprintf returns the number of characters written excluding the terminating byte. In the above example this would be a maximum of 199.</p>
<h2 id="what-if-i-really-really-want-printf-to-call-write-without-a-newline">What if I really really want <code>printf</code> to call <code>write</code> without a newline?</h2>
<p>Use <code>fflush( FILE* inp )</code>. The contents of the file will be written. If I wanted to write "Hello World" with no newline, I could write it like this.</p>
<pre><code class="C">int main(){
    fprintf(stdout, &quot;Hello World&quot;);
    fflush(stdout);
    return 0;
}
</code></pre>

<h2 id="how-is-perror-helpful">How is <code>perror</code> helpful?</h2>
<p>Let's say that you have a function call that just failed (because you checked the man page and it is a failing return code). <code>perror(const char* message)</code> will print the english version of the error to stderr</p>
<pre><code class="C">int main(){
    int ret = open(&quot;IDoNotExist.txt&quot;, O_RDONLY);
    if(ret &lt; 0){
        perror(&quot;Opening IDoNotExist:&quot;);
    }
    //...
    return 0;
}
</code></pre>

<h1 id="parsing-input">Parsing Input</h1>
<h2 id="how-do-i-parse-numbers-from-strings">How do I parse numbers from strings?</h2>
<p>Use <code>long int strtol(const char *nptr, char **endptr, int base);</code> or <code>long long int strtoll(const char *nptr, char **endptr, int base);</code>.</p>
<p>What these functions do is take the pointer to your string <code>*nptr</code> and a <code>base</code> (ie binary, octal, decimal, hexadecimal etc) and an optional pointer <code>endptr</code> and returns a parsed int.</p>
<pre><code class="C">int main(){
    const char *num = &quot;1A2436&quot;;
    char* endptr;
    long int parsed = strtol(num, &amp;endptr, 16);
    return 0;
}
</code></pre>

<p>Be careful though! Error handling is kinda tricky because the function won't return an error code. On error, it'll return 0, and you have to manually check errno, but that could lead to trouble.</p>
<pre><code class="C">int main(){
    const char *zero = &quot;0&quot;;
    char* endptr;
    printf(&quot;Parsing number&quot;); //printf sets errno
    long int parsed = strtol(num, &amp;endptr, 16);
    if(parsed == 0){
        perror(&quot;Error: &quot;); //oops strtol actually worked!
    }
    return 0;
}
</code></pre>

<h2 id="how-do-i-parse-input-using-scanf-into-parameters">How do I parse input using <code>scanf</code> into parameters?</h2>
<p>Use <code>scanf</code> (or <code>fscanf</code> or <code>sscanf</code>) to get input from the default input stream, an arbitrary file stream or a C string respectively.
It's a good idea to check the return value to see how many items were parsed.
<code>scanf</code> functions require valid pointers. It's a common source of error to pass in an incorrect pointer value. For example,</p>
<pre><code class="C">int *data = (int *) malloc(sizeof(int));
char *line = &quot;v 10&quot;;
char type;
// Good practice: Check scanf parsed the line and read two values:
int ok = 2 == sscanf(line, &quot;%c %d&quot;, &amp;type, &amp;data); // pointer error
</code></pre>

<p>We wanted to write the character value into c and the integer value into the malloc'd memory.
However we passed the address of the data pointer, not what the pointer is pointing to! So <code>sscanf</code> will change the pointer itself. i.e. the pointer will now point to address 10 so this code will later fail e.g. when free(data) is called.</p>
<h2 id="how-do-i-stop-scanf-from-causing-a-buffer-overflow">How do I stop scanf from causing a buffer overflow?</h2>
<p>The following code assumes the scanf won't read more than 10 characters (including the terminating byte) into the buffer.</p>
<pre><code class="C">char buffer[10];
scanf(&quot;%s&quot;,buffer);
</code></pre>

<p>You can include an optional integer to specify how many characters EXCLUDING the terminating byte:</p>
<pre><code class="C">char buffer[10];
scanf(&quot;%9s&quot;, buffer); // reads upto 9 charactes from input (leave room for the 10th byte to be the terminating byte)
</code></pre>

<h2 id="why-is-gets-dangerous-what-should-i-use-instead">Why is <code>gets</code> dangerous? What should I use instead?</h2>
<p>The following code is vulnerable to buffer overflow. It assumes or trusts that the input line will be no more than 10 characters, including the terminating byte.</p>
<pre><code class="C">char buf[10];
gets(buf); // Remember the array name means the first byte of the array
</code></pre>

<p><code>gets</code> is deprecated in C99 standard and has been removed from the latest C standard (C11). Programs should use <code>fgets</code> or <code>getline</code> instead. </p>
<p>Where each have the following structure respectively:</p>
<pre><code class="C">char *fgets (char *str, int num, FILE *stream); 

ssize_t getline(char **lineptr, size_t *n, FILE *stream);
</code></pre>

<p>Here's a simple, safe way to read a single line. Lines longer than 9 characters will be truncated:</p>
<pre><code class="C">char buffer[10];
char *result = fgets(buffer, sizeof(buffer), stdin);
</code></pre>

<p>The result is NULL if there was an error or the end of the file is reached.
Note, unlike <code>gets</code>,  <code>fgets</code> copies the newline into the buffer, which you may want to discard-</p>
<pre><code class="C">if (!result) { return; /* no data - don't read the buffer contents */}

int i = strlen(buffer) - 1;
if (buffer[i] == '\n') 
    buffer[i] = '\0';
</code></pre>

<h2 id="how-do-i-use-getline">How do I use <code>getline</code>?</h2>
<p>One of the advantages of <code>getline</code> is that will automatically (re-) allocate a buffer on the heap of sufficient size.</p>
<pre><code class="C">// ssize_t getline(char **lineptr, size_t *n, FILE *stream);

 /* set buffer and size to 0; they will be changed by getline */
char *buffer = NULL;
size_t size = 0;

ssize_t chars = getline(&amp;buffer, &amp;size, stdin);

// Discard newline character if it is present,
if (chars &gt; 0 &amp;&amp; buffer[chars-1] == '\n') 
    buffer[chars-1] = '\0';

// Read another line.
// The existing buffer will be re-used, or, if necessary,
// It will be `free`'d and a new larger buffer will `malloc`'d
chars = getline(&amp;buffer, &amp;size, stdin);

// Later... don't forget to free the buffer!
free(buffer);
</code></pre>

<div align="center">
<a href="https://github.com/angrave/SystemProgramming/wiki/C-Programming,-Part-1:-Introduction">
Back: C Programming, Part 1: Introduction
</a> |
<a href="https://github.com/angrave/SystemProgramming/wiki/C-Programming%2C-Part-3%3A-Common-Gotchas">
Next: C Programming, Part 3: Common Gotchas
</a>
</div>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../C-Programming,-Part-3:-Common-Gotchas/" class="btn btn-neutral float-right" title="C Programming, Part 3: Common Gotchas">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../C-Programming,-Part-1:-Introduction/" class="btn btn-neutral" title="C Programming, Part 1: Introduction"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>
    
  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../C-Programming,-Part-1:-Introduction/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../C-Programming,-Part-3:-Common-Gotchas/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script src="../../js/theme.js"></script>

</body>
</html>
